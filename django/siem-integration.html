<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SIEM Integration - Django NIS2 Shield</title>
    <meta name="description" content="Integrate Django NIS2 Shield with Splunk, QRadar, Graylog, Sumo Logic, and more.">
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/github-dark.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
    <style>
        body {
            font-family: 'Inter', sans-serif;
        }

        .gradient-text {
            background: linear-gradient(to right, #3b82f6, #8b5cf6);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        pre code {
            border-radius: 8px;
        }
    </style>
</head>

<body class="bg-slate-900 text-white">

    <!-- Navbar -->
    <nav class="container mx-auto px-6 py-4 flex justify-between items-center border-b border-slate-800">
        <a href="index.html" class="flex items-center space-x-2">
            <svg class="w-8 h-8 text-blue-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                    d="M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z">
                </path>
            </svg>
            <span class="text-xl font-bold">Django NIS2 Shield</span>
        </a>
        <div class="hidden md:flex space-x-8">
            <a href="getting-started.html" class="hover:text-blue-400 transition">Getting Started</a>
            <a href="configuration.html" class="hover:text-blue-400 transition">Configuration</a>
            <a href="siem-integration.html" class="text-blue-400 font-semibold">SIEM Integration</a>
            <a href="https://github.com/nis2shield/django-nis2-shield" class="hover:text-blue-400 transition">GitHub</a>
        </div>
    </nav>

    <!-- Main Content -->
    <main class="container mx-auto px-6 py-12 max-w-4xl">

        <h1 class="text-4xl font-bold mb-4">SIEM Integration</h1>
        <p class="text-slate-400 mb-8">Connect Django NIS2 Shield to your Security Information and Event Management
            system.</p>

        <nav class="bg-slate-800 rounded-lg p-4 mb-8">
            <h3 class="font-semibold text-slate-400 mb-2">Supported SIEMs</h3>
            <ul class="grid grid-cols-2 md:grid-cols-3 gap-2 text-slate-300">
                <li><a href="#elasticsearch" class="hover:text-blue-400">Elasticsearch</a></li>
                <li><a href="#splunk" class="hover:text-blue-400">Splunk</a></li>
                <li><a href="#qradar" class="hover:text-blue-400">IBM QRadar</a></li>
                <li><a href="#graylog" class="hover:text-blue-400">Graylog</a></li>
                <li><a href="#sumologic" class="hover:text-blue-400">Sumo Logic</a></li>
                <li><a href="#datadog" class="hover:text-blue-400">Datadog</a></li>
            </ul>
        </nav>

        <!-- Log Formats -->
        <section class="mb-12">
            <h2 class="text-2xl font-bold mb-4">Log Formats</h2>
            <p class="text-slate-400 mb-4">Django NIS2 Shield supports two log formats:</p>

            <div class="grid md:grid-cols-2 gap-4">
                <div class="bg-slate-800 rounded-lg p-6">
                    <h3 class="font-bold text-lg mb-2">JSON (Default)</h3>
                    <p class="text-slate-400 text-sm mb-4">Structured JSON with HMAC signature. Best for Elasticsearch,
                        Sumo Logic.</p>
                    <pre><code class="language-python">from django_nis2_shield import Nis2JsonFormatter</code></pre>
                </div>
                <div class="bg-slate-800 rounded-lg p-6">
                    <h3 class="font-bold text-lg mb-2">CEF (Enterprise)</h3>
                    <p class="text-slate-400 text-sm mb-4">Common Event Format for enterprise SIEMs. Best for Splunk,
                        QRadar, ArcSight.</p>
                    <pre><code class="language-python">from django_nis2_shield import Nis2CefFormatter</code></pre>
                </div>
            </div>
        </section>

        <!-- Elasticsearch -->
        <section id="elasticsearch" class="mb-12">
            <h2 class="text-2xl font-bold mb-4 flex items-center gap-3">
                <img src="https://www.elastic.co/favicon.ico" class="w-6 h-6" alt="Elasticsearch">
                Elasticsearch
            </h2>

            <h3 class="text-xl font-semibold mt-6 mb-3">1. Get Index Mapping</h3>
            <pre><code class="language-python">from django_nis2_shield import get_elastic_mapping

mapping = get_elastic_mapping()
# Use this to create your index in Elasticsearch</code></pre>

            <h3 class="text-xl font-semibold mt-6 mb-3">2. Configure Filebeat</h3>
            <pre><code class="language-yaml"># filebeat.yml
filebeat.inputs:
  - type: log
    paths:
      - /var/log/django_nis2.json
    json.keys_under_root: true
    json.add_error_key: true

output.elasticsearch:
  hosts: ["localhost:9200"]
  index: "nis2-audit-%{+yyyy.MM.dd}"</code></pre>

            <h3 class="text-xl font-semibold mt-6 mb-3">3. Use Docker Stack (Optional)</h3>
            <p class="text-slate-400 mb-4">We include a ready-to-use Docker setup:</p>
            <pre><code class="language-bash">cd dashboard
docker compose up -d

# Kibana: http://localhost:5601
# Grafana: http://localhost:3000</code></pre>
        </section>

        <!-- Splunk -->
        <section id="splunk" class="mb-12">
            <h2 class="text-2xl font-bold mb-4 flex items-center gap-3">
                <img src="https://www.splunk.com/favicon.ico" class="w-6 h-6" alt="Splunk">
                Splunk
            </h2>

            <h3 class="text-xl font-semibold mt-6 mb-3">1. Enable CEF Format</h3>
            <pre><code class="language-python"># settings.py
from django_nis2_shield.cef_formatter import get_cef_logging_config

LOGGING = get_cef_logging_config('/var/log/django_nis2.cef')</code></pre>

            <h3 class="text-xl font-semibold mt-6 mb-3">2. Get Splunk props.conf</h3>
            <pre><code class="language-python">from django_nis2_shield import get_splunk_props

print(get_splunk_props())
# Add to $SPLUNK_HOME/etc/system/local/props.conf</code></pre>

            <h3 class="text-xl font-semibold mt-6 mb-3">3. Configure Data Input</h3>
            <pre><code class="language-ini"># inputs.conf
[monitor:///var/log/django_nis2.cef]
sourcetype = django_nis2_shield
index = security</code></pre>
        </section>

        <!-- QRadar -->
        <section id="qradar" class="mb-12">
            <h2 class="text-2xl font-bold mb-4 flex items-center gap-3">
                <span class="text-blue-400 font-bold">IBM</span> QRadar
            </h2>

            <h3 class="text-xl font-semibold mt-6 mb-3">1. Get DSM Configuration</h3>
            <pre><code class="language-python">from django_nis2_shield import get_qradar_dsm

config = get_qradar_dsm()
print(config)

# Returns:
# {
#   'log_source_type': 'Universal DSM',
#   'format': 'CEF',
#   'event_mappings': {...}
# }</code></pre>

            <h3 class="text-xl font-semibold mt-6 mb-3">2. Configure Log Source</h3>
            <ol class="list-decimal list-inside text-slate-300 space-y-2">
                <li>Go to Admin ‚Üí Log Sources</li>
                <li>Add a Universal DSM log source</li>
                <li>Set protocol to Syslog</li>
                <li>Forward CEF logs via rsyslog to QRadar</li>
            </ol>

            <h3 class="text-xl font-semibold mt-6 mb-3">3. Forward Logs via Syslog</h3>
            <pre><code class="language-bash"># /etc/rsyslog.d/nis2.conf
$ModLoad imfile
$InputFileName /var/log/django_nis2.cef
$InputFileTag nis2shield:
$InputFileStateFile stat-nis2
$InputFileSeverity info
$InputRunFileMonitor

*.* @@qradar.example.com:514</code></pre>
        </section>

        <!-- Graylog -->
        <section id="graylog" class="mb-12">
            <h2 class="text-2xl font-bold mb-4 flex items-center gap-3">
                <span class="text-green-400 font-bold">‚óè</span> Graylog
            </h2>

            <h3 class="text-xl font-semibold mt-6 mb-3">1. Get GELF Configuration</h3>
            <pre><code class="language-python">from django_nis2_shield import get_graylog_gelf_config

config = get_graylog_gelf_config()

# GELF level mapping:
# DEBUG=7, INFO=6, WARNING=4, ERROR=3, CRITICAL=2</code></pre>

            <h3 class="text-xl font-semibold mt-6 mb-3">2. Install GELF Handler</h3>
            <pre><code class="language-bash">pip install pygelf</code></pre>

            <h3 class="text-xl font-semibold mt-6 mb-3">3. Configure Logging</h3>
            <pre><code class="language-python"># settings.py
LOGGING = {
    'version': 1,
    'handlers': {
        'graylog': {
            'class': 'pygelf.GelfUdpHandler',
            'host': 'graylog.example.com',
            'port': 12201,
            '_application': 'django-nis2-shield',
        },
    },
    'loggers': {
        'django_nis2_shield': {
            'handlers': ['graylog'],
            'level': 'INFO',
        },
    },
}</code></pre>
        </section>

        <!-- Sumo Logic -->
        <section id="sumologic" class="mb-12">
            <h2 class="text-2xl font-bold mb-4 flex items-center gap-3">
                <span class="text-blue-500 font-bold">Œ£</span> Sumo Logic
            </h2>

            <h3 class="text-xl font-semibold mt-6 mb-3">1. Get Configuration</h3>
            <pre><code class="language-python">from django_nis2_shield import get_sumologic_config

config = get_sumologic_config()

# Includes:
# - source_category
# - field_extraction_query
# - dashboard_query_examples</code></pre>

            <h3 class="text-xl font-semibold mt-6 mb-3">2. Example Dashboard Queries</h3>
            <pre><code class="language-sql">-- Requests by Status
_sourceCategory=nis2/audit
| json auto
| timeslice 1m
| count by _timeslice, log.result.status

-- Top Users
_sourceCategory=nis2/audit
| json auto
| count by log.who.user_id
| top 10 log.who.user_id by _count

-- Security Events
_sourceCategory=nis2/audit
| json auto
| where log.result.status >= 400
| count by log.what.url</code></pre>
        </section>

        <!-- Datadog -->
        <section id="datadog" class="mb-12">
            <h2 class="text-2xl font-bold mb-4 flex items-center gap-3">
                <span class="text-purple-500 font-bold">üêï</span> Datadog
            </h2>

            <h3 class="text-xl font-semibold mt-6 mb-3">1. Get Configuration</h3>
            <pre><code class="language-python">from django_nis2_shield import get_datadog_config

config = get_datadog_config()

# Returns log processing rules for:
# - IP ‚Üí network.client.ip
# - user_id ‚Üí usr.id
# - status ‚Üí http.status_code</code></pre>

            <h3 class="text-xl font-semibold mt-6 mb-3">2. Configure Datadog Agent</h3>
            <pre><code class="language-yaml"># /etc/datadog-agent/conf.d/django_nis2.d/conf.yaml
logs:
  - type: file
    path: /var/log/django_nis2.json
    service: django-nis2-shield
    source: django
    tags:
      - env:production
      - compliance:nis2</code></pre>
        </section>

        <!-- Webhooks -->
        <section class="mb-12">
            <h2 class="text-2xl font-bold mb-4 flex items-center gap-3">
                <span class="text-yellow-500">üîî</span> Real-time Alerting with Webhooks
            </h2>
            <p class="text-slate-400 mb-4">In addition to SIEM integration, you can receive real-time alerts for
                security events.</p>

            <div class="grid md:grid-cols-3 gap-4">
                <div class="bg-slate-800 rounded-lg p-4 text-center">
                    <span class="text-2xl">üí¨</span>
                    <p class="font-semibold mt-2">Slack</p>
                </div>
                <div class="bg-slate-800 rounded-lg p-4 text-center">
                    <span class="text-2xl">üü¶</span>
                    <p class="font-semibold mt-2">Microsoft Teams</p>
                </div>
                <div class="bg-slate-800 rounded-lg p-4 text-center">
                    <span class="text-2xl">üéÆ</span>
                    <p class="font-semibold mt-2">Discord</p>
                </div>
            </div>

            <p class="text-slate-400 mt-4">See <a href="configuration.html#webhooks"
                    class="text-blue-400 hover:underline">Configuration ‚Üí Webhooks</a> for setup instructions.</p>
        </section>

    </main>

    <!-- Footer -->
    <footer class="border-t border-slate-800 py-8 mt-12">
        <div class="container mx-auto px-6 text-center text-slate-500">
            <p>Django NIS2 Shield ¬∑ MIT License ¬∑ <a href="https://github.com/nis2shield/django-nis2-shield"
                    class="hover:text-blue-400">GitHub</a></p>
        </div>
    </footer>

    <script>hljs.highlightAll();</script>
</body>

</html>