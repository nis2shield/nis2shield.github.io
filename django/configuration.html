<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Configuration Reference - Django NIS2 Shield</title>
    <meta name="description" content="Complete configuration reference for all Django NIS2 Shield options.">
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/github-dark.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
    <style>
        body {
            font-family: 'Inter', sans-serif;
        }

        .gradient-text {
            background: linear-gradient(to right, #3b82f6, #8b5cf6);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        pre code {
            border-radius: 8px;
        }
    </style>
</head>

<body class="bg-slate-900 text-white">

    <!-- Navbar -->
    <nav class="container mx-auto px-6 py-4 flex justify-between items-center border-b border-slate-800">
        <a href="index.html" class="flex items-center space-x-2">
            <svg class="w-8 h-8 text-blue-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                    d="M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z">
                </path>
            </svg>
            <span class="text-xl font-bold">Django NIS2 Shield</span>
        </a>
        <div class="hidden md:flex space-x-8">
            <a href="getting-started.html" class="hover:text-blue-400 transition">Getting Started</a>
            <a href="configuration.html" class="text-blue-400 font-semibold">Configuration</a>
            <a href="siem-integration.html" class="hover:text-blue-400 transition">SIEM Integration</a>
            <a href="https://github.com/nis2shield/django-nis2-shield" class="hover:text-blue-400 transition">GitHub</a>
        </div>
    </nav>

    <!-- Main Content -->
    <main class="container mx-auto px-6 py-12 max-w-4xl">

        <h1 class="text-4xl font-bold mb-8">Configuration Reference</h1>

        <p class="text-slate-400 mb-8">All options are configured in your <code
                class="bg-slate-800 px-2 py-1 rounded">settings.py</code> under the <code
                class="bg-slate-800 px-2 py-1 rounded">NIS2_SHIELD</code> dictionary.</p>

        <nav class="bg-slate-800 rounded-lg p-4 mb-8">
            <h3 class="font-semibold text-slate-400 mb-2">Sections</h3>
            <ul class="space-y-1 text-slate-300">
                <li><a href="#security-keys" class="hover:text-blue-400">Security Keys</a></li>
                <li><a href="#privacy" class="hover:text-blue-400">Privacy (GDPR)</a></li>
                <li><a href="#rate-limiting" class="hover:text-blue-400">Rate Limiting</a></li>
                <li><a href="#session-guard" class="hover:text-blue-400">Session Guard</a></li>
                <li><a href="#tor-blocking" class="hover:text-blue-400">Tor Blocking</a></li>
                <li><a href="#mfa" class="hover:text-blue-400">MFA Gatekeeper</a></li>
                <li><a href="#webhooks" class="hover:text-blue-400">Webhooks</a></li>
            </ul>
        </nav>

        <!-- Security Keys -->
        <section id="security-keys" class="mb-12">
            <h2 class="text-2xl font-bold mb-4 flex items-center gap-2">
                <span class="text-blue-500">üîê</span> Security Keys
            </h2>

            <div class="overflow-x-auto">
                <table class="w-full border-collapse">
                    <thead>
                        <tr class="border-b border-slate-700">
                            <th class="text-left py-3 px-4">Option</th>
                            <th class="text-left py-3 px-4">Type</th>
                            <th class="text-left py-3 px-4">Default</th>
                            <th class="text-left py-3 px-4">Description</th>
                        </tr>
                    </thead>
                    <tbody class="text-slate-300">
                        <tr class="border-b border-slate-800">
                            <td class="py-3 px-4 font-mono text-sm">INTEGRITY_KEY</td>
                            <td class="py-3 px-4">string</td>
                            <td class="py-3 px-4 text-yellow-500">Required</td>
                            <td class="py-3 px-4">Secret key for HMAC-SHA256 log signing</td>
                        </tr>
                        <tr class="border-b border-slate-800">
                            <td class="py-3 px-4 font-mono text-sm">ENCRYPTION_KEY</td>
                            <td class="py-3 px-4">bytes</td>
                            <td class="py-3 px-4">None</td>
                            <td class="py-3 px-4">Fernet key for PII encryption. Generate with
                                <code>Fernet.generate_key()</code></td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <pre class="mt-4"><code class="language-python">from cryptography.fernet import Fernet

NIS2_SHIELD = {
    'INTEGRITY_KEY': os.environ.get('NIS2_INTEGRITY_KEY'),
    'ENCRYPTION_KEY': os.environ.get('NIS2_ENCRYPTION_KEY').encode(),
}</code></pre>
        </section>

        <!-- Privacy -->
        <section id="privacy" class="mb-12">
            <h2 class="text-2xl font-bold mb-4 flex items-center gap-2">
                <span class="text-blue-500">üîí</span> Privacy (GDPR)
            </h2>

            <div class="overflow-x-auto">
                <table class="w-full border-collapse">
                    <thead>
                        <tr class="border-b border-slate-700">
                            <th class="text-left py-3 px-4">Option</th>
                            <th class="text-left py-3 px-4">Type</th>
                            <th class="text-left py-3 px-4">Default</th>
                            <th class="text-left py-3 px-4">Description</th>
                        </tr>
                    </thead>
                    <tbody class="text-slate-300">
                        <tr class="border-b border-slate-800">
                            <td class="py-3 px-4 font-mono text-sm">ANONYMIZE_IPS</td>
                            <td class="py-3 px-4">bool</td>
                            <td class="py-3 px-4">True</td>
                            <td class="py-3 px-4">Anonymize last octet of IP addresses</td>
                        </tr>
                        <tr class="border-b border-slate-800">
                            <td class="py-3 px-4 font-mono text-sm">ENCRYPT_PII</td>
                            <td class="py-3 px-4">bool</td>
                            <td class="py-3 px-4">True</td>
                            <td class="py-3 px-4">Encrypt PII fields in logs</td>
                        </tr>
                        <tr class="border-b border-slate-800">
                            <td class="py-3 px-4 font-mono text-sm">PII_FIELDS</td>
                            <td class="py-3 px-4">list</td>
                            <td class="py-3 px-4">['user_id', 'email', 'ip', 'user_agent']</td>
                            <td class="py-3 px-4">Fields to encrypt</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </section>

        <!-- Rate Limiting -->
        <section id="rate-limiting" class="mb-12">
            <h2 class="text-2xl font-bold mb-4 flex items-center gap-2">
                <span class="text-blue-500">‚è±Ô∏è</span> Rate Limiting
            </h2>

            <div class="overflow-x-auto">
                <table class="w-full border-collapse">
                    <thead>
                        <tr class="border-b border-slate-700">
                            <th class="text-left py-3 px-4">Option</th>
                            <th class="text-left py-3 px-4">Type</th>
                            <th class="text-left py-3 px-4">Default</th>
                            <th class="text-left py-3 px-4">Description</th>
                        </tr>
                    </thead>
                    <tbody class="text-slate-300">
                        <tr class="border-b border-slate-800">
                            <td class="py-3 px-4 font-mono text-sm">ENABLE_RATE_LIMIT</td>
                            <td class="py-3 px-4">bool</td>
                            <td class="py-3 px-4">True</td>
                            <td class="py-3 px-4">Enable rate limiting</td>
                        </tr>
                        <tr class="border-b border-slate-800">
                            <td class="py-3 px-4 font-mono text-sm">RATE_LIMIT_THRESHOLD</td>
                            <td class="py-3 px-4">int</td>
                            <td class="py-3 px-4">100</td>
                            <td class="py-3 px-4">Max requests per window</td>
                        </tr>
                        <tr class="border-b border-slate-800">
                            <td class="py-3 px-4 font-mono text-sm">RATE_LIMIT_WINDOW</td>
                            <td class="py-3 px-4">int</td>
                            <td class="py-3 px-4">60</td>
                            <td class="py-3 px-4">Window size in seconds</td>
                        </tr>
                        <tr class="border-b border-slate-800">
                            <td class="py-3 px-4 font-mono text-sm">RATE_LIMIT_ALGORITHM</td>
                            <td class="py-3 px-4">string</td>
                            <td class="py-3 px-4">'sliding_window'</td>
                            <td class="py-3 px-4">'sliding_window' or 'fixed_window'</td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <div class="bg-green-900/20 border border-green-700 rounded-lg p-4 mt-4">
                <p class="text-green-300"><strong>v0.3.0+:</strong> Sliding window algorithm provides more accurate rate
                    limiting without boundary issues.</p>
            </div>
        </section>

        <!-- Session Guard -->
        <section id="session-guard" class="mb-12">
            <h2 class="text-2xl font-bold mb-4 flex items-center gap-2">
                <span class="text-blue-500">üõ°Ô∏è</span> Session Guard
            </h2>

            <div class="overflow-x-auto">
                <table class="w-full border-collapse">
                    <thead>
                        <tr class="border-b border-slate-700">
                            <th class="text-left py-3 px-4">Option</th>
                            <th class="text-left py-3 px-4">Type</th>
                            <th class="text-left py-3 px-4">Default</th>
                            <th class="text-left py-3 px-4">Description</th>
                        </tr>
                    </thead>
                    <tbody class="text-slate-300">
                        <tr class="border-b border-slate-800">
                            <td class="py-3 px-4 font-mono text-sm">ENABLE_SESSION_GUARD</td>
                            <td class="py-3 px-4">bool</td>
                            <td class="py-3 px-4">True</td>
                            <td class="py-3 px-4">Enable session hijacking protection</td>
                        </tr>
                        <tr class="border-b border-slate-800">
                            <td class="py-3 px-4 font-mono text-sm">SESSION_IP_TOLERANCE</td>
                            <td class="py-3 px-4">string</td>
                            <td class="py-3 px-4">'subnet'</td>
                            <td class="py-3 px-4">'exact', 'subnet', or 'none'</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </section>

        <!-- Tor Blocking -->
        <section id="tor-blocking" class="mb-12">
            <h2 class="text-2xl font-bold mb-4 flex items-center gap-2">
                <span class="text-blue-500">üßÖ</span> Tor Blocking
            </h2>

            <div class="overflow-x-auto">
                <table class="w-full border-collapse">
                    <thead>
                        <tr class="border-b border-slate-700">
                            <th class="text-left py-3 px-4">Option</th>
                            <th class="text-left py-3 px-4">Type</th>
                            <th class="text-left py-3 px-4">Default</th>
                            <th class="text-left py-3 px-4">Description</th>
                        </tr>
                    </thead>
                    <tbody class="text-slate-300">
                        <tr class="border-b border-slate-800">
                            <td class="py-3 px-4 font-mono text-sm">BLOCK_TOR_EXIT_NODES</td>
                            <td class="py-3 px-4">bool</td>
                            <td class="py-3 px-4">False</td>
                            <td class="py-3 px-4">Block Tor exit nodes</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </section>

        <!-- MFA -->
        <section id="mfa" class="mb-12">
            <h2 class="text-2xl font-bold mb-4 flex items-center gap-2">
                <span class="text-blue-500">üîë</span> MFA Gatekeeper
            </h2>

            <div class="overflow-x-auto">
                <table class="w-full border-collapse">
                    <thead>
                        <tr class="border-b border-slate-700">
                            <th class="text-left py-3 px-4">Option</th>
                            <th class="text-left py-3 px-4">Type</th>
                            <th class="text-left py-3 px-4">Default</th>
                            <th class="text-left py-3 px-4">Description</th>
                        </tr>
                    </thead>
                    <tbody class="text-slate-300">
                        <tr class="border-b border-slate-800">
                            <td class="py-3 px-4 font-mono text-sm">ENFORCE_MFA_ROUTES</td>
                            <td class="py-3 px-4">list</td>
                            <td class="py-3 px-4">[]</td>
                            <td class="py-3 px-4">URL prefixes requiring MFA</td>
                        </tr>
                        <tr class="border-b border-slate-800">
                            <td class="py-3 px-4 font-mono text-sm">MFA_SESSION_FLAG</td>
                            <td class="py-3 px-4">string</td>
                            <td class="py-3 px-4">'is_verified_mfa'</td>
                            <td class="py-3 px-4">Session key indicating MFA complete</td>
                        </tr>
                        <tr class="border-b border-slate-800">
                            <td class="py-3 px-4 font-mono text-sm">MFA_REDIRECT_URL</td>
                            <td class="py-3 px-4">string</td>
                            <td class="py-3 px-4">'/mfa/verify/'</td>
                            <td class="py-3 px-4">Redirect URL for MFA verification</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </section>

        <!-- Webhooks -->
        <section id="webhooks" class="mb-12">
            <h2 class="text-2xl font-bold mb-4 flex items-center gap-2">
                <span class="text-blue-500">üîî</span> Webhooks <span
                    class="text-xs bg-green-600 px-2 py-1 rounded-full ml-2">v0.3.0+</span>
            </h2>

            <div class="overflow-x-auto">
                <table class="w-full border-collapse">
                    <thead>
                        <tr class="border-b border-slate-700">
                            <th class="text-left py-3 px-4">Option</th>
                            <th class="text-left py-3 px-4">Type</th>
                            <th class="text-left py-3 px-4">Default</th>
                            <th class="text-left py-3 px-4">Description</th>
                        </tr>
                    </thead>
                    <tbody class="text-slate-300">
                        <tr class="border-b border-slate-800">
                            <td class="py-3 px-4 font-mono text-sm">ENABLE_WEBHOOKS</td>
                            <td class="py-3 px-4">bool</td>
                            <td class="py-3 px-4">False</td>
                            <td class="py-3 px-4">Enable webhook notifications</td>
                        </tr>
                        <tr class="border-b border-slate-800">
                            <td class="py-3 px-4 font-mono text-sm">WEBHOOK_ASYNC</td>
                            <td class="py-3 px-4">bool</td>
                            <td class="py-3 px-4">True</td>
                            <td class="py-3 px-4">Send webhooks asynchronously</td>
                        </tr>
                        <tr class="border-b border-slate-800">
                            <td class="py-3 px-4 font-mono text-sm">WEBHOOKS</td>
                            <td class="py-3 px-4">list</td>
                            <td class="py-3 px-4">[]</td>
                            <td class="py-3 px-4">List of webhook configurations</td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <pre class="mt-4"><code class="language-python">NIS2_SHIELD = {
    'ENABLE_WEBHOOKS': True,
    'WEBHOOKS': [
        {'url': 'https://hooks.slack.com/services/...', 'format': 'slack'},
        {'url': 'https://outlook.office.com/webhook/...', 'format': 'teams'},
        {'url': 'https://discord.com/api/webhooks/...', 'format': 'discord'},
        {'url': 'https://your-siem.com/api/alerts', 'format': 'json'},
    ]
}</code></pre>
        </section>

        <!-- Full Example -->
        <section id="full-example" class="mb-12">
            <h2 class="text-2xl font-bold mb-4 flex items-center gap-2">
                <span class="text-blue-500">üìã</span> Full Configuration Example
            </h2>
            <pre><code class="language-python">from cryptography.fernet import Fernet
import os

NIS2_SHIELD = {
    # Security Keys
    'INTEGRITY_KEY': os.environ.get('NIS2_INTEGRITY_KEY', 'dev-key'),
    'ENCRYPTION_KEY': os.environ.get('NIS2_ENCRYPTION_KEY', '').encode() or None,
    
    # Privacy (GDPR)
    'ANONYMIZE_IPS': True,
    'ENCRYPT_PII': True,
    'PII_FIELDS': ['user_id', 'email', 'ip', 'user_agent'],
    
    # Rate Limiting
    'ENABLE_RATE_LIMIT': True,
    'RATE_LIMIT_THRESHOLD': 100,
    'RATE_LIMIT_WINDOW': 60,
    'RATE_LIMIT_ALGORITHM': 'sliding_window',
    
    # Session Guard
    'ENABLE_SESSION_GUARD': True,
    'SESSION_IP_TOLERANCE': 'subnet',
    
    # Tor Blocking
    'BLOCK_TOR_EXIT_NODES': True,
    
    # MFA
    'ENFORCE_MFA_ROUTES': ['/admin/', '/finance/', '/api/sensitive/'],
    'MFA_SESSION_FLAG': 'is_verified_mfa',
    'MFA_REDIRECT_URL': '/accounts/mfa/verify/',
    
    # Webhooks
    'ENABLE_WEBHOOKS': True,
    'WEBHOOK_ASYNC': True,
    'WEBHOOKS': [
        {'url': os.environ.get('SLACK_WEBHOOK_URL'), 'format': 'slack'},
    ]
}</code></pre>
        </section>

    </main>

    <!-- Footer -->
    <footer class="border-t border-slate-800 py-8 mt-12">
        <div class="container mx-auto px-6 text-center text-slate-500">
            <p>Django NIS2 Shield ¬∑ MIT License ¬∑ <a href="https://github.com/nis2shield/django-nis2-shield"
                    class="hover:text-blue-400">GitHub</a></p>
        </div>
    </footer>

    <script>hljs.highlightAll();</script>
</body>

</html>